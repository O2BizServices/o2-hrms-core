import{B as s,C as m,D as e,E as n,F as u,H as I,I as k,K as c,L as o,M as D,N as Q,_ as A,a as O,b as E,ca as U,ea as T,ga as j,ha as V,ka as R,la as G,ma as p,na as z,o as P,oa as L,p as N,qa as Y,ra as B,sa as X,ta as H,ua as J,va as K,wa as W,x as a,xa as Z,y as C,z as w,za as $}from"./chunk-2C4HHQOY.js";function et(r,i){r&1&&(e(0,"div",36),o(1," Customer name is required "),n())}function nt(r,i){r&1&&(e(0,"div",36),o(1," Quotation number is required "),n())}function ot(r,i){r&1&&(e(0,"div",36),o(1," Amount is required "),n())}function it(r,i){r&1&&(e(0,"div",36),o(1," Amount must be greater than 0 "),n())}function rt(r,i){r&1&&(e(0,"div",36),o(1," Status is required "),n())}function at(r,i){r&1&&(e(0,"div",36),o(1," Date is required "),n())}function lt(r,i){r&1&&(e(0,"div",36),o(1," Valid until date is required "),n())}function mt(r,i){if(r&1&&(e(0,"span",37),P(),e(1,"svg",31),u(2,"path",38),n(),o(3),n()),r&2){let l=k();a(3),Q(" ",l.isEditMode?"Update Quotation":"Create Quotation"," ")}}function ut(r,i){r&1&&u(0,"span",39)}var tt=class r{constructor(i,l,t,d){this.fb=i;this.mockApi=l;this.router=t;this.route=d;this.quotationForm=this.fb.group({customerName:["",p.required],quotationNumber:["",p.required],amount:[0,[p.required,p.min(.01)]],quotationDate:[new Date().toISOString().split("T")[0],p.required],validUntil:[new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],p.required],status:["Draft",p.required],description:[""]})}quotationForm;isSubmitting=!1;isEditMode=!1;quotationId=null;ngOnInit(){this.route.paramMap.subscribe(i=>{this.quotationId=i.get("id"),this.quotationId&&(this.isEditMode=!0,this.loadQuotation(this.quotationId))})}loadQuotation(i){this.mockApi.getQuotations().subscribe({next:l=>{let t=l.find(d=>d.id===i);t?this.quotationForm.patchValue({customerName:t.customerName,quotationNumber:t.quotationNumber,amount:t.amount,quotationDate:t.quotationDate?new Date(t.quotationDate).toISOString().split("T")[0]:"",validUntil:t.validUntil?new Date(t.validUntil).toISOString().split("T")[0]:"",status:t.status,description:t.description}):this.router.navigate(["/crm/quotations"])},error:l=>{console.error("Error loading quotation",l),this.router.navigate(["/crm/quotations"])}})}onSubmit(){if(this.quotationForm.valid){this.isSubmitting=!0;let i=this.quotationForm.value;if(this.isEditMode&&this.quotationId){let l=E(O({id:this.quotationId},i),{quotationDate:new Date(i.quotationDate),date:new Date(i.quotationDate),validUntil:new Date(i.validUntil)});this.mockApi.updateQuotation(l).subscribe({next:()=>{this.isSubmitting=!1,this.router.navigate(["/crm/quotations"])},error:t=>{console.error("Error updating quotation",t),this.isSubmitting=!1}})}else{let l=E(O({id:"quot"+Date.now()},i),{quotationDate:new Date(i.quotationDate),date:new Date(i.quotationDate),validUntil:new Date(i.validUntil)});this.mockApi.addQuotation(l).subscribe({next:()=>{this.isSubmitting=!1,this.router.navigate(["/crm/quotations"])},error:t=>{console.error("Error adding quotation",t),this.isSubmitting=!1}})}}else this.quotationForm.markAllAsTouched()}static \u0275fac=function(l){return new(l||r)(C(Z),C(R),C(j),C(T))};static \u0275cmp=w({type:r,selectors:[["app-quotation-form"]],decls:73,vars:25,consts:[[1,"page-container"],[1,"page-header"],[1,"header-content"],[1,"subtitle"],[1,"card","form-card"],[3,"ngSubmit","formGroup"],[1,"form-grid"],[1,"form-group"],["for","customerName",1,"form-label"],[1,"required"],["type","text","id","customerName","formControlName","customerName","placeholder","Enter customer name",1,"form-input"],["class","error-message",4,"ngIf"],["for","quotationNumber",1,"form-label"],["type","text","id","quotationNumber","formControlName","quotationNumber","placeholder","QUO-YYYY-XXX",1,"form-input"],["for","amount",1,"form-label"],["type","number","id","amount","formControlName","amount","placeholder","0.00",1,"form-input"],["for","status",1,"form-label"],["id","status","formControlName","status",1,"form-input"],["value","Draft"],["value","Sent"],["value","Accepted"],["value","Rejected"],["for","quotationDate",1,"form-label"],["type","date","id","quotationDate","formControlName","quotationDate",1,"form-input"],["for","validUntil",1,"form-label"],["type","date","id","validUntil","formControlName","validUntil",1,"form-input"],[1,"form-group","full-width"],["for","description",1,"form-label"],["id","description","formControlName","description","rows","4","placeholder","Add description or items...",1,"form-input"],[1,"form-actions"],["type","button","routerLink","/crm/quotations",1,"btn","btn-secondary"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor",1,"btn-icon"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","flex items-center",4,"ngIf"],["class","spinner-sm",4,"ngIf"],[1,"error-message"],[1,"flex","items-center"],["stroke-linecap","round","stroke-linejoin","round","d","M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"],[1,"spinner-sm"]],template:function(l,t){if(l&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),o(4),n(),e(5,"p",3),o(6),n()()(),e(7,"div",4)(8,"form",5),I("ngSubmit",function(){return t.onSubmit()}),e(9,"div",6)(10,"div",7)(11,"label",8),o(12,"Customer Name "),e(13,"span",9),o(14,"*"),n()(),u(15,"input",10),s(16,et,2,0,"div",11),n(),e(17,"div",7)(18,"label",12),o(19,"Quotation Number "),e(20,"span",9),o(21,"*"),n()(),u(22,"input",13),s(23,nt,2,0,"div",11),n(),e(24,"div",7)(25,"label",14),o(26,"Amount "),e(27,"span",9),o(28,"*"),n()(),u(29,"input",15),s(30,ot,2,0,"div",11)(31,it,2,0,"div",11),n(),e(32,"div",7)(33,"label",16),o(34,"Status "),e(35,"span",9),o(36,"*"),n()(),e(37,"select",17)(38,"option",18),o(39,"Draft"),n(),e(40,"option",19),o(41,"Sent"),n(),e(42,"option",20),o(43,"Accepted"),n(),e(44,"option",21),o(45,"Rejected"),n()(),s(46,rt,2,0,"div",11),n(),e(47,"div",7)(48,"label",22),o(49,"Date "),e(50,"span",9),o(51,"*"),n()(),u(52,"input",23),s(53,at,2,0,"div",11),n(),e(54,"div",7)(55,"label",24),o(56,"Valid Until "),e(57,"span",9),o(58,"*"),n()(),u(59,"input",25),s(60,lt,2,0,"div",11),n(),e(61,"div",26)(62,"label",27),o(63,"Description"),n(),u(64,"textarea",28),n()(),e(65,"div",29)(66,"button",30),P(),e(67,"svg",31),u(68,"path",32),n(),o(69," Cancel "),n(),N(),e(70,"button",33),s(71,mt,4,1,"span",34)(72,ut,1,0,"span",35),n()()()()()),l&2){let d,f,S,g,x,b,v,F,q,M,_,y,h;a(4),D(t.isEditMode?"Edit Quotation":"Add Quotation"),a(2),D(t.isEditMode?"Update quotation details":"Create a new quotation"),a(2),m("formGroup",t.quotationForm),a(7),c("error",((d=t.quotationForm.get("customerName"))==null?null:d.touched)&&((d=t.quotationForm.get("customerName"))==null?null:d.invalid)),a(),m("ngIf",((f=t.quotationForm.get("customerName"))==null?null:f.touched)&&((f=t.quotationForm.get("customerName"))==null||f.errors==null?null:f.errors.required)),a(6),c("error",((S=t.quotationForm.get("quotationNumber"))==null?null:S.touched)&&((S=t.quotationForm.get("quotationNumber"))==null?null:S.invalid)),a(),m("ngIf",((g=t.quotationForm.get("quotationNumber"))==null?null:g.touched)&&((g=t.quotationForm.get("quotationNumber"))==null||g.errors==null?null:g.errors.required)),a(6),c("error",((x=t.quotationForm.get("amount"))==null?null:x.touched)&&((x=t.quotationForm.get("amount"))==null?null:x.invalid)),a(),m("ngIf",((b=t.quotationForm.get("amount"))==null?null:b.touched)&&((b=t.quotationForm.get("amount"))==null||b.errors==null?null:b.errors.required)),a(),m("ngIf",((v=t.quotationForm.get("amount"))==null?null:v.touched)&&((v=t.quotationForm.get("amount"))==null||v.errors==null?null:v.errors.min)),a(6),c("error",((F=t.quotationForm.get("status"))==null?null:F.touched)&&((F=t.quotationForm.get("status"))==null?null:F.invalid)),a(9),m("ngIf",((q=t.quotationForm.get("status"))==null?null:q.touched)&&((q=t.quotationForm.get("status"))==null||q.errors==null?null:q.errors.required)),a(6),c("error",((M=t.quotationForm.get("quotationDate"))==null?null:M.touched)&&((M=t.quotationForm.get("quotationDate"))==null?null:M.invalid)),a(),m("ngIf",((_=t.quotationForm.get("quotationDate"))==null?null:_.touched)&&((_=t.quotationForm.get("quotationDate"))==null||_.errors==null?null:_.errors.required)),a(6),c("error",((y=t.quotationForm.get("validUntil"))==null?null:y.touched)&&((y=t.quotationForm.get("validUntil"))==null?null:y.invalid)),a(),m("ngIf",((h=t.quotationForm.get("validUntil"))==null?null:h.touched)&&((h=t.quotationForm.get("validUntil"))==null||h.errors==null?null:h.errors.required)),a(10),m("disabled",t.isSubmitting),a(),m("ngIf",!t.isSubmitting),a(),m("ngIf",t.isSubmitting)}},dependencies:[U,A,$,Y,K,W,G,B,J,z,L,H,X,V],styles:[".page-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2.5rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;color:#1e3a5f;font-weight:700;letter-spacing:-.02em;margin-bottom:.5rem;background:none;-webkit-text-fill-color:initial}.subtitle[_ngcontent-%COMP%]{color:#2f5a8a;font-size:1rem;font-weight:500}.form-card[_ngcontent-%COMP%]{padding:2.5rem;background:var(--bg-card);border-radius:var(--radius-xl);box-shadow:var(--shadow-md);border:1px solid var(--border-light)}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-bottom:2.5rem}.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-group[_ngcontent-%COMP%]{margin-bottom:0}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;padding-top:2rem;border-top:1px solid rgba(0,0,0,.05)}[data-theme=dark][_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{border-top-color:#ffffff0d}.btn-secondary[_ngcontent-%COMP%]{background:#fee2e2!important;border:1px solid #991b1b!important;color:#991b1b!important;padding:.4rem 1rem;border-radius:var(--radius-md);font-size:.875rem;font-weight:600;text-decoration:none;display:inline-flex;align-items:center;justify-content:center;transition:all .3s ease}[data-theme=dark][_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#991b1b33;border-color:#f87171;color:#f87171}.btn-secondary[_ngcontent-%COMP%]:hover{background:#fecaca;border-color:#7f1d1d;color:#7f1d1d;transform:translateY(-1px);box-shadow:0 2px 4px #991b1b1a}[data-theme=dark][_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background:#991b1b4d;border-color:#fca5a5;color:#fca5a5}.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color)!important;color:#fff!important;box-shadow:0 1px 3px #5c7cfa4d;padding:.4rem 1rem;font-size:.875rem}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--primary-dark);box-shadow:0 4px 6px -1px #5c7cfa66;transform:translateY(-1px)}.error-message[_ngcontent-%COMP%]{color:#ef4444;font-size:.8rem;margin-top:.375rem;display:flex;align-items:center;gap:.25rem}.form-input.error[_ngcontent-%COMP%]{border-color:#ef4444;background:#ef44440d}.spinner-sm[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid #ffffff;border-bottom-color:transparent;border-radius:50%;display:inline-block;animation:_ngcontent-%COMP%_rotation 1s linear infinite}.flex[_ngcontent-%COMP%]{display:flex}.items-center[_ngcontent-%COMP%]{align-items:center}.btn-icon[_ngcontent-%COMP%]{width:14px;height:14px;margin-right:6px}@keyframes _ngcontent-%COMP%_rotation{to{transform:rotate(360deg)}}@media(max-width:768px){.page-container[_ngcontent-%COMP%]{padding:0 1rem}.form-card[_ngcontent-%COMP%]{padding:1.25rem}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1.5rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column-reverse;gap:.75rem}.btn-secondary[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%]{width:100%}}"]})};export{tt as QuotationFormComponent};
