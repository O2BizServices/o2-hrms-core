import{B as c,C as m,D as t,E as i,F as d,H as T,I as q,K as p,L as n,M as w,N as V,_ as j,a as O,b as P,ca as G,ea as R,ga as z,ha as L,ka as Y,la as B,ma as u,na as X,o as N,oa as U,p as k,qa as H,ra as J,sa as K,ta as Q,ua as W,va as Z,wa as $,x as a,xa as ee,y as I,z as A,za as te}from"./chunk-2C4HHQOY.js";function ne(r,o){r&1&&(t(0,"div",36),n(1," Customer name is required "),i())}function oe(r,o){r&1&&(t(0,"div",36),n(1," Invoice number is required "),i())}function re(r,o){r&1&&(t(0,"div",36),n(1," Total amount is required "),i())}function ae(r,o){r&1&&(t(0,"div",36),n(1," Amount must be greater than 0 "),i())}function le(r,o){r&1&&(t(0,"div",36),n(1," Amount cannot be negative "),i())}function me(r,o){r&1&&(t(0,"div",36),n(1," Status is required "),i())}function de(r,o){r&1&&(t(0,"div",36),n(1," Date is required "),i())}function ce(r,o){r&1&&(t(0,"div",36),n(1," Due date is required "),i())}function ue(r,o){if(r&1&&(t(0,"span",37),N(),t(1,"svg",31),d(2,"path",38),i(),n(3),i()),r&2){let l=q();a(3),V(" ",l.isEditMode?"Update Invoice":"Create Invoice"," ")}}function se(r,o){r&1&&d(0,"span",39)}var ie=class r{constructor(o,l,e,s){this.fb=o;this.mockApi=l;this.router=e;this.route=s;this.invoiceForm=this.fb.group({customerName:["",u.required],invoiceNumber:["",u.required],total:[0,[u.required,u.min(.01)]],invoiceDate:[new Date().toISOString().split("T")[0],u.required],dueDate:[new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],u.required],status:["Draft",u.required],paidAmount:[0,[u.min(0)]]})}invoiceForm;isSubmitting=!1;isEditMode=!1;invoiceId=null;ngOnInit(){this.route.paramMap.subscribe(o=>{this.invoiceId=o.get("id"),this.invoiceId&&(this.isEditMode=!0,this.loadInvoice(this.invoiceId))})}loadInvoice(o){this.mockApi.getInvoices().subscribe({next:l=>{let e=l.find(s=>s.id===o);e?this.invoiceForm.patchValue({customerName:e.customerName,invoiceNumber:e.invoiceNumber,total:e.total,invoiceDate:e.invoiceDate?new Date(e.invoiceDate).toISOString().split("T")[0]:"",dueDate:e.dueDate?new Date(e.dueDate).toISOString().split("T")[0]:"",status:e.status,paidAmount:e.paidAmount||0}):this.router.navigate(["/crm/invoices"])},error:l=>{console.error("Error loading invoice",l),this.router.navigate(["/crm/invoices"])}})}onSubmit(){if(this.invoiceForm.valid){this.isSubmitting=!0;let o=this.invoiceForm.value;if(this.isEditMode&&this.invoiceId){let l=P(O({id:this.invoiceId},o),{invoiceDate:new Date(o.invoiceDate),dueDate:new Date(o.dueDate),subtotal:o.total,tax:0,items:[]});this.mockApi.updateInvoice(l).subscribe({next:()=>{this.isSubmitting=!1,this.router.navigate(["/crm/invoices"])},error:e=>{console.error("Error updating invoice",e),this.isSubmitting=!1}})}else{let l=P(O({id:"inv"+Date.now()},o),{invoiceDate:new Date(o.invoiceDate),dueDate:new Date(o.dueDate),subtotal:o.total,tax:0,items:[]});this.mockApi.addInvoice(l).subscribe({next:()=>{this.isSubmitting=!1,this.router.navigate(["/crm/invoices"])},error:e=>{console.error("Error adding invoice",e),this.isSubmitting=!1}})}}else this.invoiceForm.markAllAsTouched()}static \u0275fac=function(l){return new(l||r)(I(ee),I(Y),I(z),I(R))};static \u0275cmp=A({type:r,selectors:[["app-invoice-form"]],decls:76,vars:28,consts:[[1,"page-container"],[1,"page-header"],[1,"header-content"],[1,"subtitle"],[1,"card","form-card"],[3,"ngSubmit","formGroup"],[1,"form-grid"],[1,"form-group"],["for","customerName",1,"form-label"],[1,"required"],["type","text","id","customerName","formControlName","customerName","placeholder","Enter customer name",1,"form-input"],["class","error-message",4,"ngIf"],["for","invoiceNumber",1,"form-label"],["type","text","id","invoiceNumber","formControlName","invoiceNumber","placeholder","INV-YYYY-XXX",1,"form-input"],["for","total",1,"form-label"],["type","number","id","total","formControlName","total","placeholder","0.00",1,"form-input"],["for","paidAmount",1,"form-label"],["type","number","id","paidAmount","formControlName","paidAmount","placeholder","0.00",1,"form-input"],["for","status",1,"form-label"],["id","status","formControlName","status",1,"form-input"],["value","Draft"],["value","Sent"],["value","Paid"],["value","Overdue"],["value","Cancelled"],["for","invoiceDate",1,"form-label"],["type","date","id","invoiceDate","formControlName","invoiceDate",1,"form-input"],["for","dueDate",1,"form-label"],["type","date","id","dueDate","formControlName","dueDate",1,"form-input"],[1,"form-actions"],["type","button","routerLink","/crm/invoices",1,"btn","btn-secondary"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor",1,"btn-icon"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","flex items-center",4,"ngIf"],["class","spinner-sm",4,"ngIf"],[1,"error-message"],[1,"flex","items-center"],["stroke-linecap","round","stroke-linejoin","round","d","M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"],[1,"spinner-sm"]],template:function(l,e){if(l&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),n(4),i(),t(5,"p",3),n(6),i()()(),t(7,"div",4)(8,"form",5),T("ngSubmit",function(){return e.onSubmit()}),t(9,"div",6)(10,"div",7)(11,"label",8),n(12,"Customer Name "),t(13,"span",9),n(14,"*"),i()(),d(15,"input",10),c(16,ne,2,0,"div",11),i(),t(17,"div",7)(18,"label",12),n(19,"Invoice Number "),t(20,"span",9),n(21,"*"),i()(),d(22,"input",13),c(23,oe,2,0,"div",11),i(),t(24,"div",7)(25,"label",14),n(26,"Total Amount "),t(27,"span",9),n(28,"*"),i()(),d(29,"input",15),c(30,re,2,0,"div",11)(31,ae,2,0,"div",11),i(),t(32,"div",7)(33,"label",16),n(34,"Paid Amount"),i(),d(35,"input",17),c(36,le,2,0,"div",11),i(),t(37,"div",7)(38,"label",18),n(39,"Status "),t(40,"span",9),n(41,"*"),i()(),t(42,"select",19)(43,"option",20),n(44,"Draft"),i(),t(45,"option",21),n(46,"Sent"),i(),t(47,"option",22),n(48,"Paid"),i(),t(49,"option",23),n(50,"Overdue"),i(),t(51,"option",24),n(52,"Cancelled"),i()(),c(53,me,2,0,"div",11),i(),t(54,"div",7)(55,"label",25),n(56,"Invoice Date "),t(57,"span",9),n(58,"*"),i()(),d(59,"input",26),c(60,de,2,0,"div",11),i(),t(61,"div",7)(62,"label",27),n(63,"Due Date "),t(64,"span",9),n(65,"*"),i()(),d(66,"input",28),c(67,ce,2,0,"div",11),i()(),t(68,"div",29)(69,"button",30),N(),t(70,"svg",31),d(71,"path",32),i(),n(72," Cancel "),i(),k(),t(73,"button",33),c(74,ue,4,1,"span",34)(75,se,1,0,"span",35),i()()()()()),l&2){let s,v,F,f,x,g,b,D,_,M,h,y,C,E,S;a(4),w(e.isEditMode?"Edit Invoice":"Add Invoice"),a(2),w(e.isEditMode?"Update invoice details":"Create a new invoice"),a(2),m("formGroup",e.invoiceForm),a(7),p("error",((s=e.invoiceForm.get("customerName"))==null?null:s.touched)&&((s=e.invoiceForm.get("customerName"))==null?null:s.invalid)),a(),m("ngIf",((v=e.invoiceForm.get("customerName"))==null?null:v.touched)&&((v=e.invoiceForm.get("customerName"))==null||v.errors==null?null:v.errors.required)),a(6),p("error",((F=e.invoiceForm.get("invoiceNumber"))==null?null:F.touched)&&((F=e.invoiceForm.get("invoiceNumber"))==null?null:F.invalid)),a(),m("ngIf",((f=e.invoiceForm.get("invoiceNumber"))==null?null:f.touched)&&((f=e.invoiceForm.get("invoiceNumber"))==null||f.errors==null?null:f.errors.required)),a(6),p("error",((x=e.invoiceForm.get("total"))==null?null:x.touched)&&((x=e.invoiceForm.get("total"))==null?null:x.invalid)),a(),m("ngIf",((g=e.invoiceForm.get("total"))==null?null:g.touched)&&((g=e.invoiceForm.get("total"))==null||g.errors==null?null:g.errors.required)),a(),m("ngIf",((b=e.invoiceForm.get("total"))==null?null:b.touched)&&((b=e.invoiceForm.get("total"))==null||b.errors==null?null:b.errors.min)),a(4),p("error",((D=e.invoiceForm.get("paidAmount"))==null?null:D.touched)&&((D=e.invoiceForm.get("paidAmount"))==null?null:D.invalid)),a(),m("ngIf",((_=e.invoiceForm.get("paidAmount"))==null?null:_.touched)&&((_=e.invoiceForm.get("paidAmount"))==null||_.errors==null?null:_.errors.min)),a(6),p("error",((M=e.invoiceForm.get("status"))==null?null:M.touched)&&((M=e.invoiceForm.get("status"))==null?null:M.invalid)),a(11),m("ngIf",((h=e.invoiceForm.get("status"))==null?null:h.touched)&&((h=e.invoiceForm.get("status"))==null||h.errors==null?null:h.errors.required)),a(6),p("error",((y=e.invoiceForm.get("invoiceDate"))==null?null:y.touched)&&((y=e.invoiceForm.get("invoiceDate"))==null?null:y.invalid)),a(),m("ngIf",((C=e.invoiceForm.get("invoiceDate"))==null?null:C.touched)&&((C=e.invoiceForm.get("invoiceDate"))==null||C.errors==null?null:C.errors.required)),a(6),p("error",((E=e.invoiceForm.get("dueDate"))==null?null:E.touched)&&((E=e.invoiceForm.get("dueDate"))==null?null:E.invalid)),a(),m("ngIf",((S=e.invoiceForm.get("dueDate"))==null?null:S.touched)&&((S=e.invoiceForm.get("dueDate"))==null||S.errors==null?null:S.errors.required)),a(6),m("disabled",e.isSubmitting),a(),m("ngIf",!e.isSubmitting),a(),m("ngIf",e.isSubmitting)}},dependencies:[G,j,te,H,Z,$,B,J,W,X,U,Q,K,L],styles:[".page-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2.5rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;color:#1e3a5f;font-weight:700;letter-spacing:-.02em;margin-bottom:.5rem;background:none;-webkit-text-fill-color:initial}.subtitle[_ngcontent-%COMP%]{color:#2f5a8a;font-size:1rem;font-weight:500}.form-card[_ngcontent-%COMP%]{padding:2.5rem;background:var(--bg-card);border-radius:var(--radius-xl);box-shadow:var(--shadow-md);border:1px solid var(--border-light)}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-bottom:2.5rem}.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-group[_ngcontent-%COMP%]{margin-bottom:0}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;padding-top:2rem;border-top:1px solid rgba(0,0,0,.05)}[data-theme=dark][_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{border-top-color:#ffffff0d}.btn-secondary[_ngcontent-%COMP%]{background:#fee2e2!important;border:1px solid #991b1b!important;color:#991b1b!important;padding:.4rem 1rem;border-radius:var(--radius-md);font-size:.875rem;font-weight:600;text-decoration:none;display:inline-flex;align-items:center;justify-content:center;transition:all .3s ease}[data-theme=dark][_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#991b1b33;border-color:#f87171;color:#f87171}.btn-secondary[_ngcontent-%COMP%]:hover{background:#fecaca;border-color:#7f1d1d;color:#7f1d1d;transform:translateY(-1px);box-shadow:0 2px 4px #991b1b1a}[data-theme=dark][_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background:#991b1b4d;border-color:#fca5a5;color:#fca5a5}.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color)!important;color:#fff!important;box-shadow:0 1px 3px #5c7cfa4d;padding:.4rem 1rem;font-size:.875rem}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--primary-dark);box-shadow:0 4px 6px -1px #5c7cfa66;transform:translateY(-1px)}.error-message[_ngcontent-%COMP%]{color:#ef4444;font-size:.8rem;margin-top:.375rem;display:flex;align-items:center;gap:.25rem}.form-input.error[_ngcontent-%COMP%]{border-color:#ef4444;background:#ef44440d}.spinner-sm[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid #ffffff;border-bottom-color:transparent;border-radius:50%;display:inline-block;animation:_ngcontent-%COMP%_rotation 1s linear infinite}.flex[_ngcontent-%COMP%]{display:flex}.items-center[_ngcontent-%COMP%]{align-items:center}.btn-icon[_ngcontent-%COMP%]{width:14px;height:14px;margin-right:6px}@keyframes _ngcontent-%COMP%_rotation{to{transform:rotate(360deg)}}@media(max-width:768px){.page-container[_ngcontent-%COMP%]{padding:0 1rem}.form-card[_ngcontent-%COMP%]{padding:1.25rem}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1.5rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column-reverse;gap:.75rem}.btn-secondary[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%]{width:100%}}"]})};export{ie as InvoiceFormComponent};
